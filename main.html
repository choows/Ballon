<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bee Happy Balloon üêù</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Header / Navbar -->
    <nav class="navbar navbar-light bg-warning sticky-top shadow-sm">
        <div class="container d-flex justify-content-between align-items-center">
            <a class="navbar-brand fw-bold fs-3 text-dark" href="#">
                <i class="fa-solid fa-bee"></i> Bee Happy Balloon
            </a>
            <button class="btn btn-dark btn-sm" data-bs-toggle="modal" data-bs-target="#qrModal">
                <i class="fa-brands fa-instagram"></i> Follow Us
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container my-5">

        <!-- Filter Buttons Container -->
        <div class="text-center mb-5">
            <h2 class="mb-3">Our Designs</h2>
            <div id="category-filters" class="btn-group flex-wrap" role="group">
                <!-- Buttons will be injected here by JS -->
            </div>
        </div>

        <!-- Catalog Grid -->
        <div id="catalog-grid" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            <!-- Products will be injected here by JS -->
        </div>

        <!-- Loading Spinner -->
        <div id="loader" class="text-center mt-5">
            <div class="spinner-border text-warning" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>

    <!-- Instagram QR Modal -->
    <div class="modal fade" id="qrModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title fw-bold">Scan to Visit Instagram</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <img id="modal-qr-img" src="" alt="Instagram QR" class="img-fluid mb-3" style="max-width: 200px;">
                    <p>Stay updated with our latest designs!</p>
                    <a id="modal-insta-link" href="#" target="_blank" class="btn btn-outline-dark">Open Instagram</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 mt-5">
        <small>&copy; Bee Happy Balloon. All rights reserved.</small>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom Logic -->
    <script>

        document.addEventListener('DOMContentLoaded', () => {
            const catalogGrid = document.getElementById('catalog-grid');
            const filterContainer = document.getElementById('category-filters');
            const loader = document.getElementById('loader');

            // Config Placeholders
            let whatsappNumber = "";

            // Fetch Data
            fetch('data.json')
                .then(response => response.json())
                .then(data => {
                    // 1. Setup Config
                    whatsappNumber = data.config.phoneNumber;
                    setupInstagram(data.config);

                    // 2. Render Categories
                    renderFilterButtons(data.categories, data.products);

                    // 3. Render Initial Products (All)
                    renderProducts(data.products, 'All');

                    // Hide Loader
                    loader.style.display = 'none';
                })
                .catch(error => {
                    console.error('Error loading data:', error);
                    catalogGrid.innerHTML = '<p class="text-danger text-center">Failed to load catalog.</p>';
                });

            // --- Functions ---

            function setupInstagram(config) {
                document.getElementById('modal-qr-img').src = config.qrCodeImage;
                document.getElementById('modal-insta-link').href = config.instagramUrl;
            }

            function renderFilterButtons(categories, products) {
                categories.forEach((cat, index) => {
                    const btn = document.createElement('button');
                    btn.className = `btn btn-filter ${index === 0 ? 'active' : ''}`;
                    btn.textContent = cat;
                    btn.onclick = () => {
                        // Remove active class from all
                        document.querySelectorAll('.btn-filter').forEach(b => b.classList.remove('active'));
                        // Add active to clicked
                        btn.classList.add('active');
                        // Filter products
                        renderProducts(products, cat);
                    };
                    filterContainer.appendChild(btn);
                });
            }

            function renderProducts(products, filterCategory) {
                catalogGrid.innerHTML = ''; // Clear current grid

                const filtered = filterCategory === 'All'
                    ? products
                    : products.filter(p => p.category === filterCategory);

                if (filtered.length === 0) {
                    catalogGrid.innerHTML = '<div class="col-12 text-center text-muted">No designs found in this category.</div>';
                    return;
                }

                filtered.forEach(product => {
                    // Create Card HTML
                    const col = document.createElement('div');
                    col.className = 'col';

                    // Construct WhatsApp Message
                    const message = `Hi, I am interested in the ${product.name} (Price: ${product.price}). Is it available?`;
                    const waLink = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;

                    col.innerHTML = `
                <div class="card h-100">
                    <img src="${product.image}" class="card-img-top" alt="${product.name}">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">${product.name}</h5>
                        <p class="price-tag">${product.price}</p>
                        <div class="mt-auto">
                            <a href="${waLink}" target="_blank" class="btn btn-success w-100">
                                <i class="fa-brands fa-whatsapp"></i> Order / Enquire
                            </a>
                        </div>
                    </div>
                </div>
            `;
                    catalogGrid.appendChild(col);
                });
            }
        });
    </script>
</body>

</html>